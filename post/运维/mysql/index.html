<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Mysql | tazigi's blog</title><meta name=keywords content><meta name=description content="Mysql - tazigi's blog"><meta name=author content="Me"><link rel=canonical href=https://tazegi.github.io/post/%E8%BF%90%E7%BB%B4/mysql/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.6a98292fb8fa8cf0f3ba4042d4b75515c04267550f3ad49ff6271b5af9562443.css integrity="sha256-apgpL7j6jPDzukBC1LdVFcBCZ1UPOtSf9icbWvlWJEM=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://tazegi.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://tazegi.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://tazegi.github.io/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://tazegi.github.io/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://tazegi.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="Mysql"><meta property="og:description" content><meta property="og:type" content="article"><meta property="og:url" content="https://tazegi.github.io/post/%E8%BF%90%E7%BB%B4/mysql/"><meta property="og:image" content="https://tazegi.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="post"><meta property="article:published_time" content="2023-03-03T08:24:35+08:00"><meta property="article:modified_time" content="2023-03-03T08:24:35+08:00"><meta property="og:site_name" content="ExampleSite"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://tazegi.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Mysql"><meta name=twitter:description content><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://tazegi.github.io/post/"},{"@type":"ListItem","position":3,"name":"Mysql","item":"https://tazegi.github.io/post/%E8%BF%90%E7%BB%B4/mysql/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Mysql","name":"Mysql","description":"","keywords":[""],"articleBody":" gentoo wiki sudo emerge --config =dev-db/mysql-8.0.31-r1 rc-update add mysql default; rc-service mysql start mysql_secure_installation # 禁用历史记录: ln -sf /dev/null ~/.mysql_history docker的phpmyadmin 和远程访问一个道理，要想从容器中的phpMyAdmin访问运行在服务器上的MySQL，必须先修改MySQL配置文件，允许非localhost的IP访问。\n打开/etc/mysql/mysql.d/50-distro-server.cnf配置文件，进行如下修改： bind-address = localhost # 找到上式，修改为 bind-address = xxx.xx.xx.x # 你的docker0的ip地址 # 或者修改为 bind-address = 0.0.0.0 # 表示允许任意ip地址访问 然后，还需要将你的账号也设置为允许从远程登陆（默认为localhost）。为了完成这一操作，先通过localhost登入mysql，更改mysql数据库里的user表里对应你账号的host项，从localhost改成%。具体操作如下：\n# 使用mysql数据库 use mysql; # 将root账号（可替换成其他）的host修改为% update user set host = '%' where user = 'root'; # 查看修改结果 select host, user from user; 最后，不要忘记重启mysql 创建phpMyAdmin镜像\n# PMA_HOST设置为连接的MySQL主机名或ip地址 # PMA_PORT设置为端口号 # 8080:80，将宿主机的8080端口映射到镜像的80端口 docker run -d \\ --name myadmin \\ -e PMA_HOST=$(ip route show | grep docker0 | awk '{print $9}') \\ -e PMA_PORT=3306 \\ -p 8080:80 \\ phpmyadmin/phpmyadmin 值得一提的是，这里是通过桥接网络模式（bridge mode）运行的镜像，因此在镜像中可通过docker0访问宿主网络。\n此时，可以通过8080端口访问到phpMyAdmin的管理界面了，即 http://127.0.0.1:8080/ One More Thing\n把MySQL随意地暴露在网络下无疑会带来安全隐患，从安全角度考虑，应该为防火墙设置白名单规则，只有白名单的IP才能够连接数据库。\n# ufw防火墙，提供一个参考思路而已 ufw insert 1 allow from 172.17.0.3 to any port 3306 技巧 %和_是通配符 show variables like 'skip_name';\n查询变量, gentoo无此变量 skip_name_resolve = on 禁止主机名解析,建议使用 查询3个字符的变量\nshow variables like '___'; 数据库存在也不会报错\ncreate database if not exists db1; drop database if exists db1; 指定字符集\ncreate database db2 default charset utf8mb4; 查看字符集\n-- 查看表的字符集 show create table table; -- 查看库的字符集 show create database database; -- 查看DBMS的字符集 show variables like 'character_%'; -- 查看比较规则 show variables like 'collation_%'; 脚本模式\nmysql -uroot -pf \u003c /path/to/somefile.sql mysql\u003e source somefile.sql 去重:distinct\nuse test; create table repetition(id int); insert into repetition values(1); insert into repetition values(1); insert into repetition values(1); select * from repetition; -- 去重 select distinct * from repetition; 着重号 ``\n如果出现了字段名,表名跟关键字重名,要明确加上着重号,表示就是一个普通的字段,表名 查询常数\n-- 查询尚硅谷的全部学生(全部学生都在尚硅谷) select '尚硅谷',student_id,student_name from school; 查询正在使用的数据库\nselect database(); -- 查看用户: select user(); root@localhost root@localhost和root@127.0.0.1是不同账号 前者走socket,后者走tcp/ip 修改mysql的PS1 man mysql\n• Use an option file. You can set the prompt option in the [mysql] group of any MySQL option file, such as /etc/my.cnf or the .my.cnf file in your home directory. For\nexample:\n[mysql]\nprompt=(\\\\u@\\\\h) [\\\\d]\u003e\\\\_\n常用选项 -A 禁止补全 -P port -S socket -D 指定默认数据库\n默认不写也是\nmysql -uroot -pf mysql -C 启用压缩 -e 执行sql命令\nmysql -uroot -pf -e \"show databases;status;\" -V 查看版本 -v verbose --print-defaults\nmysql --print-defaults mysqld --print-defaults 配置文件 _和-相同 0,OFF,FALSE意义相同,1,ON,TRUE意义相同 mysqld: skip-network=1\n关闭网络 3306端口将关闭 但本地仍然可以通过socket连接 需要重启服务 二进制安装 useradd -r -d /data/mysqldb -s /sbin/nologin mysql 系统账号默认不会创建家目录 tar xvf mariadb-num-linux-x86_64,tar.gz -C usr/local cd usr/local ln -s mariadb-num-linux-x86_64 mysql chow -R root: mysql/ 将/usr/local/mysql/bin加入环境变量 mkdir /data/mysqldb chown mysql.mysql /data/mysqldb chmod 770 /data/mysqldb cp support-files/my-huge.cnf /etc/my.cnf 选择my-huge.cnf作为主要配置 scripts/mysql_install_db –datadir=/data/mysqldb –user=mysql 生成数据库文件\n可能需要安装的包\nperl-Data-Dumper libaio 修改配置文件,在配置文件中指定数据库\n[mydqld] datadir = /data/mysqldb socket = /usr/local/mysql/mysql.sock [client] socket = /usr/local/mysql/mysql.sock cp support-files/mysql.server /etc/init.d/mysqld 拷贝服务文件 chkconfig –add mysqld 开机启动 service mysqld start 由于sock文件在/usr/local/mysql/mysql.sock没有写权限,启动失败 setfacl -R -m u:mysql:rwx /usr/local/mysql mysql_secure_installation 取消sock路径的修改 子命令help system: 执行shell命令\nsystem hostname 或 \\! hostname status\n查看状态 包括版本,当前用户,当前使用数据库,编码 或 \\s 客户端命令与服务器命令 客户端命令\n通过客户端执行 help下的命令 不需要加分号 服务器命令\n服务器端执行 需要加分号 mysqladmin mysqladmin -uroot -pf password mysql mysqladmin -uroot -pmysql password mysqladmin -uroot -pf create db1 mysqladmin -uroot -pf drop db1 #检测健康状态 mysqladmin -uroot -pf ping mysqladmin -uroot -pf ping \u0026\u003e /dev/null || systemctl restart mariadb #关闭数据库 mysqladmin -uroot -pf shutdown 对应关系 1对多\n员工表的部门id和部门表的id,1个部门有多个员工\n外键表信赖于主键表,员工表的department_id信赖于部门表的id 所以id是主键,department_id是外键 多对多\n学生表(student)课程表(course)\n分别取出学生id和课程id组成第三张表 sid信赖学生数目,cid信赖课程数目,都是外键 多表查询 简单的多表查询\nselect emp.employee_id,dept,depart_name,emp.department_id from employees emp,departments dept where emp.department_id = dept.department_id; -- 当员工的部门id和部门表的部门id相等时,打印部门名字 employees:职位表 departments:公寓表\n等值连接,非等值连接\nselect e.last_name,e.salary,j.grade_level from employees e,job_grades j where e.salary \u003e= j.lowest_sal and e.highest_sal; -- 当员工工资在某个区间上时,打印工资等级 employees:职位表 job_grades:公资等级表\n自连接,非自连接\nselect emp.employee_id,emp.last_name,mgr.employee_id,mgr.last_name fron employees emp,employees mgr where emp.manager_id = mgr.employee_id; -- 当员工的管理者id和员工id相等时,查询管理者id和名字 内连接\nselect emp.employee_id,dept,depart_name,emp.department_id from employees emp join departments dept on emp.department_id = dept.department_id; -- 当员工的部门id和部门表的部门id相等时,打印部门名字 左外连接\nselect emp.employee_id,dept,depart_name,emp.department_id from employees emp left join departments dept on emp.department_id = dept.department_id; -- 当员工的部门id和部门表的部门id相等时,打印部门名字 右外连接\nselect emp.employee_id,dept,depart_name,emp.department_id from employees emp right join departments dept on emp.department_id = dept.department_id; -- 当员工的部门id和部门表的部门id相等时,打印部门名字 union,union all 连接两个表,但union会去重 满外连接 规范 字符串单引,列别名双引 关键字大写 普通语法 注释\n# * * – (其它数据库通用) 转义符:\\ databases show databases; use database; create database database; drop database database; tables show tables; create table table(id int,name varchar(15)); insert into table values(1,'Tom'); select * from table; # 显示表结构 describe table; desc table; select select 5+4; select 5+4 from dual; select 字断名 from 表名;\nuse mysql; select cost_name,last_update from engine_cost; 列的别名\nuse mysql; select cost_name cname,last_update lupdate from engine_cost; select cost_name AS cname,last_update AS lupdate from engine_cost; select cost_name AS \"cost名\",last_update AS \"日期\" from engine_cost; 别名用双引\n空值参于运算\ncreate table NULLoperation(value int,times int); show create table NULLoperation\\G select value,times,value*times from NULLoperation; insert into NULLoperation values(3,null); select value,times,value*times from NULLoperation; select value,times,value*ifnull(times,0) from NULLoperation; -- 空植用零替换: ifnull(times,0) 空值参于运算的结呆一定为空 空值不等于零\n过滤条件\nselect 1,value,times,value*ifnull(times,1) from NULLoperation where times=10; where放在from的后面\n比较 不等于:\u003c\u003e,同!= 安全等于:*\u003c=\u003e* 可以对NULL进行判断,而不返回NULL,等号有NULL参于就返回NULL is null, is not null, isnull() least(), greatest() beteen and 包含边界 in (), not in () not/!, and/\u0026\u0026, or/||, xor(逻辑异或) *not用在where后面 like:模糊查询\nlike放在where后面过滤输出结果,多个条件用or,and select 1,value,times,value*ifnull(times,1) from NULLoperation where times like '1%'; select from where like '%a%' %号同linux的星 select from where like '_a%' (查询第二个字符是a的结果) _同正则表达式的点 regexp/rlike:正则表达式\nregexp/rlike放在where后面过滤输出结果,多个条件用or,and select 1,value,times,value*ifnull(times,1) from NULLoperation where times regexp '1.'; 排序 order by 字段 [asc] (ascend) order by 字段 desc (descend) 列的别名只能在order by中使用,不能在where中使用 二级排序 在一级排序的结果相同时,再进行排序\norder by 字段 desc 字段 [asc] *升序可省略asc 分页 limit 偏移量,条数\neg limit [0],20 (每页显示20条数据,此时显示第1页) 偏移量为零可省略 eg limit 20,20 (每页显示20条数据,此时显示第2页) eg limit 40,20 (每页显示20条数据,此时显示第3页) 公式: limit (pageNo-1)*pageSize,pageSize; mysql8.0新特性: limit 条数 offset 偏移量 约束 主键约束\ncreate table user( id int primary key auto_increment comment '主键', name varchar(10) not null unique comment '姓名', age int check ( age \u003e 0 \u0026\u0026 age \u003c= 120 ) comment '年龄', status char(1) default '1' comment '状态', gender char(1) comment '性别' ) comment '用户表'; 外键约束\nalter table emp add constraint fk_emp_dept_id foreign key (dept_id) references dept(id); emp表的dept_id信赖dept表的id 删除\nalter table emp drop foreign key fk_emp_dept_id 事务 查询\n(root@localhost) [test]\u003e select @@autocommit; +--------------+ | @@autocommit | +--------------+ | 1 | +--------------+ 1 row in set (0.00 sec) set @@autocommit = 0; 手动提交\nset @@autocommit = 0; commit; -- 回滚事务 rollback; start transaction; 事务隔离级别\n查询\n(root@localhost) [test]\u003e select @@transaction_isolation; +-------------------------+ | @@transaction_isolation | +-------------------------+ | REPEATABLE-READ | +-------------------------+ 1 row in set (0.00 sec) set session transaction isolation level read_uncommitted; 日志 二进制日志 对库的修改\n(root@localhost) [(none)]\u003e show variables like '%log_bin%'; +---------------------------------+---------------------------------+ | Variable_name | Value | +---------------------------------+---------------------------------+ | log_bin | ON | | log_bin_basename | /var/lib/mysql/gentoo-bin | | log_bin_index | /var/lib/mysql/gentoo-bin.index | | log_bin_trust_function_creators | OFF | | log_bin_use_v1_row_events | OFF | | sql_log_bin | ON | +---------------------------------+---------------------------------+ 6 rows in set (0.00 sec) 查看日志格式\n(root@localhost) [(none)]\u003e show variables like '%binlog_format'; +---------------+-------+ | Variable_name | Value | +---------------+-------+ | binlog_format | ROW | +---------------+-------+ 1 row in set (0.01 sec) mysqlbinlog gentoo-bin.000003 -v 格式为ROW要加-v 删除日志\nreset master 删除全部 purge master logs to 'binlog.***' 删除***之前的所有日志 purge master logs before 'yyyy-mm-dd hh:mm:ss' 过期时间\n(root@localhost) [(none)]\u003e show variables like '%binlog_expire%'; +-------------------------------+---------+ | Variable_name | Value | +-------------------------------+---------+ | binlog_expire_logs_auto_purge | ON | | binlog_expire_logs_seconds | 2592000 | +-------------------------------+---------+ 2 rows in set (0.00 sec) 30天后会自动删除\n查询日志 对库的查询\n(root@localhost) [(none)]\u003e show variables like '%general%'; +------------------+---------------------------+ | Variable_name | Value | +------------------+---------------------------+ | general_log | OFF | | general_log_file | /var/lib/mysql/gentoo.log | +------------------+---------------------------+ 2 rows in set (0.00 sec) 查询日志默认关闭\n慢查询日志\n开启慢查询\n#开启慢查询 slow_query_log=1 #慢查询时间参数 long_query_time=2 主从复制 主库配置\n/etc/my.cnf\nserver-id=1 read-only=0 创建用户\ncreate user 'f'@'%' identified with mysql_native_password by 'f'; 授于权限\ngrant replication slave on *.* to 'f'@'%'; 查看二进制日志坐标\nshow master status; 从库配置\n/etc/my.cnf\nserver-id=2 read-only=1 8.0.23之前\nchange replication source to source_host='xxx.xxx',source_user='xxx',source_log_file='xxx',source_log_pos=xxx; 如果是8.0.23之前的版本,执行如下sql:\nchange replication master to master_host='xxx.xxx',master_user='xxx',master_log_file='xxx',master_log_pos=xxx; 开启同步操作\nstart replica; #8.0.22之后 start slave; #8.0.22之前 查看主从同步状态\nstart replica status\\G; #8.0.22之后 start slave status\\G; #8.0.22之前 查看replica_io_running和replica_sql_running是否为yes ","wordCount":"1150","inLanguage":"en","datePublished":"2023-03-03T08:24:35+08:00","dateModified":"2023-03-03T08:24:35+08:00","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://tazegi.github.io/post/%E8%BF%90%E7%BB%B4/mysql/"},"publisher":{"@type":"Organization","name":"tazigi's blog","logo":{"@type":"ImageObject","url":"https://tazegi.github.io/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://tazegi.github.io accesskey=h title="Home (Alt + H)"><img src=https://tazegi.github.io/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://tazegi.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://tazegi.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://example.org title=example.org><span>example.org</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://tazegi.github.io>Home</a>&nbsp;»&nbsp;<a href=https://tazegi.github.io/post/>Posts</a></div><h1 class=post-title>Mysql</h1><div class=post-meta><span title='2023-03-03 08:24:35 +0800 CST'>March 3, 2023</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;1150 words&nbsp;·&nbsp;Me&nbsp;|&nbsp;<a href=https://github.com/%3cpath_to_repo%3e/content/post/%e8%bf%90%e7%bb%b4/mysql.org rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><div id=outline-container-headline-1 class=outline-2><h2 id=headline-1>gentoo wiki</h2><div id=outline-text-headline-1 class=outline-text-2><div class="src src-shell"><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>sudo emerge --config <span class=o>=</span>dev-db/mysql-8.0.31-r1
</span></span><span class=line><span class=cl>rc-update add mysql default<span class=p>;</span> rc-service mysql start
</span></span><span class=line><span class=cl>mysql_secure_installation
</span></span><span class=line><span class=cl><span class=c1># 禁用历史记录:</span>
</span></span><span class=line><span class=cl>ln -sf /dev/null ~/.mysql_history</span></span></code></pre></div></div></div></div><div id=outline-container-headline-2 class=outline-2><h2 id=headline-2>docker的phpmyadmin</h2><div id=outline-text-headline-2 class=outline-text-2><ol><li><p>和远程访问一个道理，要想从容器中的phpMyAdmin访问运行在服务器上的MySQL，必须先修改MySQL配置文件，允许非localhost的IP访问。</p><div class="src src-cnf"><pre tabindex=0><code class=language-cnf data-lang=cnf>打开/etc/mysql/mysql.d/50-distro-server.cnf配置文件，进行如下修改：
bind-address = localhost
# 找到上式，修改为
bind-address = xxx.xx.xx.x # 你的docker0的ip地址
# 或者修改为
bind-address = 0.0.0.0 # 表示允许任意ip地址访问</code></pre></div></li><li><p>然后，还需要将你的账号也设置为允许从远程登陆（默认为localhost）。为了完成这一操作，先通过localhost登入mysql，更改mysql数据库里的user表里对应你账号的host项，从localhost改成%。具体操作如下：</p><div class="src src-sql"><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=o>#</span><span class=w> </span><span class=err>使用</span><span class=n>mysql</span><span class=err>数据库</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>use</span><span class=w> </span><span class=n>mysql</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>#</span><span class=w> </span><span class=err>将</span><span class=n>root</span><span class=err>账号（可替换成其他）的</span><span class=n>host</span><span class=err>修改为</span><span class=o>%</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>update</span><span class=w> </span><span class=k>user</span><span class=w> </span><span class=k>set</span><span class=w> </span><span class=k>host</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;%&#39;</span><span class=w> </span><span class=k>where</span><span class=w> </span><span class=k>user</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;root&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>#</span><span class=w> </span><span class=err>查看修改结果</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>select</span><span class=w> </span><span class=k>host</span><span class=p>,</span><span class=w> </span><span class=k>user</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=k>user</span><span class=p>;</span></span></span></code></pre></div></div></li><li>最后，不要忘记重启mysql</li><li><p>创建phpMyAdmin镜像</p><div class="src src-shell"><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># PMA_HOST设置为连接的MySQL主机名或ip地址</span>
</span></span><span class=line><span class=cl><span class=c1># PMA_PORT设置为端口号</span>
</span></span><span class=line><span class=cl><span class=c1># 8080:80，将宿主机的8080端口映射到镜像的80端口</span>
</span></span><span class=line><span class=cl>docker run -d <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span> --name myadmin <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span> -e <span class=nv>PMA_HOST</span><span class=o>=</span><span class=k>$(</span>ip route show <span class=p>|</span> grep docker0 <span class=p>|</span> awk <span class=s1>&#39;{print $9}&#39;</span><span class=k>)</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span> -e <span class=nv>PMA_PORT</span><span class=o>=</span><span class=m>3306</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span> -p 8080:80 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span> phpmyadmin/phpmyadmin</span></span></code></pre></div></div><p>值得一提的是，这里是通过桥接网络模式（bridge mode）运行的镜像，因此在镜像中可通过docker0访问宿主网络。</p></li><li>此时，可以通过8080端口访问到phpMyAdmin的管理界面了，即 <a href=http://127.0.0.1:8080/>http://127.0.0.1:8080/</a></li><li><p>One More Thing</p><ul><li><p>把MySQL随意地暴露在网络下无疑会带来安全隐患，从安全角度考虑，应该为防火墙设置白名单规则，只有白名单的IP才能够连接数据库。</p><div class="src src-shell"><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># ufw防火墙，提供一个参考思路而已</span>
</span></span><span class=line><span class=cl>ufw insert <span class=m>1</span> allow from 172.17.0.3 to any port <span class=m>3306</span></span></span></code></pre></div></div></li></ul></li></ol></div></div><div id=outline-container-headline-3 class=outline-2><h2 id=headline-3>技巧</h2><div id=outline-text-headline-3 class=outline-text-2><ol><li>%和_是通配符</li><li><p><code class=verbatim>show variables like 'skip_name';</code></p><ul><li>查询变量, <strong>gentoo无此变量</strong></li><li><code class=verbatim>skip_name_resolve = on</code> 禁止主机名解析,建议使用</li></ul></li><li><p>查询3个字符的变量</p><div class="src src-sql"><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>show</span><span class=w> </span><span class=n>variables</span><span class=w> </span><span class=k>like</span><span class=w> </span><span class=s1>&#39;___&#39;</span><span class=p>;</span></span></span></code></pre></div></div></li><li><p>数据库存在也不会报错</p><div class="src src-sql"><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>create</span><span class=w> </span><span class=k>database</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=k>not</span><span class=w> </span><span class=k>exists</span><span class=w> </span><span class=n>db1</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>drop</span><span class=w> </span><span class=k>database</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=k>exists</span><span class=w> </span><span class=n>db1</span><span class=p>;</span></span></span></code></pre></div></div></li><li><p><strong>指定字符集</strong></p><div class="src src-sql"><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>create</span><span class=w> </span><span class=k>database</span><span class=w> </span><span class=n>db2</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=n>charset</span><span class=w> </span><span class=n>utf8mb4</span><span class=p>;</span></span></span></code></pre></div></div></li><li><p><strong>查看字符集</strong></p><div class="src src-sql"><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 查看表的字符集
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>show</span><span class=w> </span><span class=k>create</span><span class=w> </span><span class=k>table</span><span class=w> </span><span class=k>table</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 查看库的字符集
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>show</span><span class=w> </span><span class=k>create</span><span class=w> </span><span class=k>database</span><span class=w> </span><span class=k>database</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 查看DBMS的字符集
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>show</span><span class=w> </span><span class=n>variables</span><span class=w> </span><span class=k>like</span><span class=w> </span><span class=s1>&#39;character_%&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 查看比较规则
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>show</span><span class=w> </span><span class=n>variables</span><span class=w> </span><span class=k>like</span><span class=w> </span><span class=s1>&#39;collation_%&#39;</span><span class=p>;</span></span></span></code></pre></div></div></li><li><p>脚本模式</p><div class="src src-shell"><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>mysql -uroot -pf &lt; /path/to/somefile.sql
</span></span><span class=line><span class=cl>mysql&gt; <span class=nb>source</span> somefile.sql</span></span></code></pre></div></div></li><li><p>去重:distinct</p><div class="src src-sql"><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=n>use</span><span class=w> </span><span class=n>test</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>create</span><span class=w> </span><span class=k>table</span><span class=w> </span><span class=n>repetition</span><span class=p>(</span><span class=n>id</span><span class=w> </span><span class=nb>int</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>insert</span><span class=w> </span><span class=k>into</span><span class=w> </span><span class=n>repetition</span><span class=w> </span><span class=k>values</span><span class=p>(</span><span class=mi>1</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>insert</span><span class=w> </span><span class=k>into</span><span class=w> </span><span class=n>repetition</span><span class=w> </span><span class=k>values</span><span class=p>(</span><span class=mi>1</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>insert</span><span class=w> </span><span class=k>into</span><span class=w> </span><span class=n>repetition</span><span class=w> </span><span class=k>values</span><span class=p>(</span><span class=mi>1</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>select</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>repetition</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 去重
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>select</span><span class=w> </span><span class=k>distinct</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>repetition</span><span class=p>;</span></span></span></code></pre></div></div></li><li><p>着重号 ``</p><ul><li>如果出现了字段名,表名跟关键字重名,要明确加上着重号,表示就是一个普通的字段,表名</li></ul></li><li><p>查询常数</p><div class="src src-sql"><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 查询尚硅谷的全部学生(全部学生都在尚硅谷)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>select</span><span class=w> </span><span class=s1>&#39;尚硅谷&#39;</span><span class=p>,</span><span class=n>student_id</span><span class=p>,</span><span class=n>student_name</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>school</span><span class=p>;</span></span></span></code></pre></div></div></li><li><p>查询正在使用的数据库</p><div class="src src-sql"><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>select</span><span class=w> </span><span class=k>database</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 查看用户:
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>select</span><span class=w> </span><span class=k>user</span><span class=p>();</span></span></span></code></pre></div></div></li></ol></div></div><div id=outline-container-headline-4 class=outline-2><h2 id=headline-4>root@localhost</h2><div id=outline-text-headline-4 class=outline-text-2><ul><li>root@localhost和root@127.0.0.1是不同账号</li><li>前者走socket,后者走tcp/ip</li></ul></div></div><div id=outline-container-headline-5 class=outline-2><h2 id=headline-5>修改mysql的PS1</h2><div id=outline-text-headline-5 class=outline-text-2><ul><li><p>man mysql</p><blockquote><p>• Use an option file. You can set the prompt option in the [mysql] group of any MySQL option file, such as /etc/my.cnf or the .my.cnf file in your home directory. For</p><p>example:</p><p>[mysql]</p><p>prompt=(\\u@\\h) [\\d]>\\_</p></blockquote></li></ul></div></div><div id=outline-container-headline-6 class=outline-2><h2 id=headline-6>常用选项</h2><div id=outline-text-headline-6 class=outline-text-2><ol><li><code class=verbatim>-A</code> 禁止补全</li><li><code class=verbatim>-P</code> port</li><li><code class=verbatim>-S</code> socket</li><li><p><code class=verbatim>-D</code> 指定默认数据库</p><ul><li><p>默认不写也是</p><ul><li><code class=verbatim>mysql -uroot -pf mysql</code></li></ul></li></ul></li><li><code class=verbatim>-C</code> 启用压缩</li><li><p><code class=verbatim>-e</code> 执行sql命令</p><ul><li><code class=verbatim>mysql -uroot -pf -e "show databases;status;"</code></li></ul></li><li><code class=verbatim>-V</code> 查看版本</li><li><code class=verbatim>-v</code> verbose</li><li><p><code class=verbatim>--print-defaults</code></p><div class="src src-shell"><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>mysql --print-defaults
</span></span><span class=line><span class=cl>mysqld --print-defaults</span></span></code></pre></div></div></li></ol></div></div><div id=outline-container-headline-7 class=outline-2><h2 id=headline-7>配置文件</h2><div id=outline-text-headline-7 class=outline-text-2><ul><li>_和-相同</li><li>0,OFF,FALSE意义相同,1,ON,TRUE意义相同</li><li><p>mysqld: skip-network=1</p><ul><li>关闭网络</li><li>3306端口将关闭</li><li>但本地仍然可以通过socket连接</li><li>需要重启服务</li></ul></li></ul></div></div><div id=outline-container-headline-8 class=outline-2><h2 id=headline-8>二进制安装</h2><div id=outline-text-headline-8 class=outline-text-2><ol><li>useradd -r -d /data/mysqldb -s /sbin/nologin mysql
<strong>系统账号默认不会创建家目录</strong></li><li>tar xvf mariadb-num-linux-x86_64,tar.gz -C <em>usr/local</em></li><li>cd <em>usr/local</em></li><li>ln -s mariadb-num-linux-x86_64 mysql</li><li>chow -R root: mysql/</li><li>将/usr/local/mysql/bin加入环境变量</li><li>mkdir /data/mysqldb</li><li>chown mysql.mysql /data/mysqldb</li><li>chmod 770 /data/mysqldb</li><li>cp support-files/my-huge.cnf /etc/my.cnf
选择my-huge.cnf作为主要配置</li><li><p>scripts/mysql_install_db –datadir=/data/mysqldb –user=mysql
生成数据库文件</p><ul><li><p>可能需要安装的包</p><ol><li>perl-Data-Dumper</li><li>libaio</li></ol></li></ul></li><li><p>修改配置文件,在配置文件中指定数据库</p><div class="src src-cnf"><pre tabindex=0><code class=language-cnf data-lang=cnf>[mydqld]
datadir = /data/mysqldb
socket = /usr/local/mysql/mysql.sock
[client]
socket = /usr/local/mysql/mysql.sock</code></pre></div></li><li>cp support-files/mysql.server /etc/init.d/mysqld 拷贝服务文件</li><li>chkconfig –add mysqld
开机启动</li><li>service mysqld start
由于sock文件在/usr/local/mysql/mysql.sock没有写权限,启动失败</li><li>setfacl -R -m u:mysql:rwx /usr/local/mysql</li><li>mysql_secure_installation
取消sock路径的修改</li></ol></div></div><div id=outline-container-headline-9 class=outline-2><h2 id=headline-9>子命令help</h2><div id=outline-text-headline-9 class=outline-text-2><ul><li><p>system: 执行shell命令</p><ul><li>system hostname</li><li>或 <code class=verbatim>\! hostname</code></li></ul></li><li><p>status</p><ul><li>查看状态</li><li>包括版本,当前用户,当前使用数据库,编码</li><li>或 <code class=verbatim>\s</code></li></ul></li></ul></div></div><div id=outline-container-headline-10 class=outline-2><h2 id=headline-10>客户端命令与服务器命令</h2><div id=outline-text-headline-10 class=outline-text-2><ol><li><p>客户端命令</p><ul><li>通过客户端执行</li><li>help下的命令</li><li><strong>不需要加分号</strong></li></ul></li><li><p>服务器命令</p><ul><li>服务器端执行</li><li><strong>需要加分号</strong></li></ul></li></ol></div></div><div id=outline-container-headline-11 class=outline-2><h2 id=headline-11>mysqladmin</h2><div id=outline-text-headline-11 class=outline-text-2><div class="src src-shell"><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>mysqladmin -uroot -pf password mysql
</span></span><span class=line><span class=cl>mysqladmin -uroot -pmysql password
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>mysqladmin -uroot -pf create db1
</span></span><span class=line><span class=cl>mysqladmin -uroot -pf drop db1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#检测健康状态</span>
</span></span><span class=line><span class=cl>mysqladmin -uroot -pf ping
</span></span><span class=line><span class=cl>mysqladmin -uroot -pf ping <span class=p>&amp;</span>&gt; /dev/null <span class=o>||</span> systemctl restart mariadb
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#关闭数据库</span>
</span></span><span class=line><span class=cl>mysqladmin -uroot -pf shutdown</span></span></code></pre></div></div></div></div><div id=outline-container-headline-12 class=outline-2><h2 id=headline-12>对应关系</h2><div id=outline-text-headline-12 class=outline-text-2><ol><li><p>1对多</p><p>员工表的部门id和部门表的id,1个部门有多个员工</p><ul><li>外键表信赖于主键表,员工表的department_id信赖于部门表的id
所以id是主键,department_id是外键</li></ul></li><li><p>多对多</p><p>学生表(student)课程表(course)</p><ul><li>分别取出学生id和课程id组成第三张表
sid信赖学生数目,cid信赖课程数目,都是外键</li></ul></li></ol></div></div><div id=outline-container-headline-13 class=outline-2><h2 id=headline-13>多表查询</h2><div id=outline-text-headline-13 class=outline-text-2><ul><li><p>简单的多表查询</p><div class="src src-sql"><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>select</span><span class=w> </span><span class=n>emp</span><span class=p>.</span><span class=n>employee_id</span><span class=p>,</span><span class=n>dept</span><span class=p>,</span><span class=n>depart_name</span><span class=p>,</span><span class=n>emp</span><span class=p>.</span><span class=n>department_id</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w> </span><span class=n>employees</span><span class=w> </span><span class=n>emp</span><span class=p>,</span><span class=n>departments</span><span class=w> </span><span class=n>dept</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>where</span><span class=w> </span><span class=n>emp</span><span class=p>.</span><span class=n>department_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>dept</span><span class=p>.</span><span class=n>department_id</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 当员工的部门id和部门表的部门id相等时,打印部门名字</span></span></span></code></pre></div></div><p>employees:职位表 departments:公寓表</p></li><li><p>等值连接,非等值连接</p><div class="src src-sql"><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>select</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>last_name</span><span class=p>,</span><span class=n>e</span><span class=p>.</span><span class=n>salary</span><span class=p>,</span><span class=n>j</span><span class=p>.</span><span class=n>grade_level</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w> </span><span class=n>employees</span><span class=w> </span><span class=n>e</span><span class=p>,</span><span class=n>job_grades</span><span class=w> </span><span class=n>j</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>where</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>salary</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=n>j</span><span class=p>.</span><span class=n>lowest_sal</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=n>highest_sal</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 当员工工资在某个区间上时,打印工资等级</span></span></span></code></pre></div></div><p>employees:职位表 job_grades:公资等级表</p></li><li><p>自连接,非自连接</p><div class="src src-sql"><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>select</span><span class=w> </span><span class=n>emp</span><span class=p>.</span><span class=n>employee_id</span><span class=p>,</span><span class=n>emp</span><span class=p>.</span><span class=n>last_name</span><span class=p>,</span><span class=n>mgr</span><span class=p>.</span><span class=n>employee_id</span><span class=p>,</span><span class=n>mgr</span><span class=p>.</span><span class=n>last_name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>fron</span><span class=w> </span><span class=n>employees</span><span class=w> </span><span class=n>emp</span><span class=p>,</span><span class=n>employees</span><span class=w> </span><span class=n>mgr</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>where</span><span class=w> </span><span class=n>emp</span><span class=p>.</span><span class=n>manager_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>mgr</span><span class=p>.</span><span class=n>employee_id</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 当员工的管理者id和员工id相等时,查询管理者id和名字</span></span></span></code></pre></div></div></li><li><p>内连接</p><div class="src src-sql"><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>select</span><span class=w> </span><span class=n>emp</span><span class=p>.</span><span class=n>employee_id</span><span class=p>,</span><span class=n>dept</span><span class=p>,</span><span class=n>depart_name</span><span class=p>,</span><span class=n>emp</span><span class=p>.</span><span class=n>department_id</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w> </span><span class=n>employees</span><span class=w> </span><span class=n>emp</span><span class=w> </span><span class=k>join</span><span class=w> </span><span class=n>departments</span><span class=w> </span><span class=n>dept</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>on</span><span class=w> </span><span class=n>emp</span><span class=p>.</span><span class=n>department_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>dept</span><span class=p>.</span><span class=n>department_id</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 当员工的部门id和部门表的部门id相等时,打印部门名字</span></span></span></code></pre></div></div></li><li><p>左外连接</p><div class="src src-sql"><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>select</span><span class=w> </span><span class=n>emp</span><span class=p>.</span><span class=n>employee_id</span><span class=p>,</span><span class=n>dept</span><span class=p>,</span><span class=n>depart_name</span><span class=p>,</span><span class=n>emp</span><span class=p>.</span><span class=n>department_id</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w> </span><span class=n>employees</span><span class=w> </span><span class=n>emp</span><span class=w> </span><span class=k>left</span><span class=w> </span><span class=k>join</span><span class=w> </span><span class=n>departments</span><span class=w> </span><span class=n>dept</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>on</span><span class=w> </span><span class=n>emp</span><span class=p>.</span><span class=n>department_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>dept</span><span class=p>.</span><span class=n>department_id</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 当员工的部门id和部门表的部门id相等时,打印部门名字</span></span></span></code></pre></div></div></li><li><p>右外连接</p><div class="src src-sql"><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>select</span><span class=w> </span><span class=n>emp</span><span class=p>.</span><span class=n>employee_id</span><span class=p>,</span><span class=n>dept</span><span class=p>,</span><span class=n>depart_name</span><span class=p>,</span><span class=n>emp</span><span class=p>.</span><span class=n>department_id</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w> </span><span class=n>employees</span><span class=w> </span><span class=n>emp</span><span class=w> </span><span class=k>right</span><span class=w> </span><span class=k>join</span><span class=w> </span><span class=n>departments</span><span class=w> </span><span class=n>dept</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>on</span><span class=w> </span><span class=n>emp</span><span class=p>.</span><span class=n>department_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>dept</span><span class=p>.</span><span class=n>department_id</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 当员工的部门id和部门表的部门id相等时,打印部门名字</span></span></span></code></pre></div></div></li><li>union,union all
连接两个表,但union会去重</li><li>满外连接</li></ul></div></div><div id=outline-container-headline-14 class=outline-2><h2 id=headline-14>规范</h2><div id=outline-text-headline-14 class=outline-text-2><ol><li>字符串单引,列别名双引</li><li>关键字大写</li></ol></div></div><div id=outline-container-headline-15 class=outline-2><h2 id=headline-15>普通语法</h2><div id=outline-text-headline-15 class=outline-text-2><ol><li><p>注释</p><ol><li>#</li><li><em>* *</em></li><li>– (其它数据库通用)</li></ol></li><li>转义符:\</li></ol></div></div><div id=outline-container-headline-16 class=outline-2><h2 id=headline-16>databases</h2><div id=outline-text-headline-16 class=outline-text-2><div class="src src-sql"><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>show</span><span class=w> </span><span class=n>databases</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>use</span><span class=w> </span><span class=k>database</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>create</span><span class=w> </span><span class=k>database</span><span class=w> </span><span class=k>database</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>drop</span><span class=w> </span><span class=k>database</span><span class=w> </span><span class=k>database</span><span class=p>;</span></span></span></code></pre></div></div></div></div><div id=outline-container-headline-17 class=outline-2><h2 id=headline-17>tables</h2><div id=outline-text-headline-17 class=outline-text-2><div class="src src-sql"><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>show</span><span class=w> </span><span class=n>tables</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>create</span><span class=w> </span><span class=k>table</span><span class=w> </span><span class=k>table</span><span class=p>(</span><span class=n>id</span><span class=w> </span><span class=nb>int</span><span class=p>,</span><span class=n>name</span><span class=w> </span><span class=nb>varchar</span><span class=p>(</span><span class=mi>15</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>insert</span><span class=w> </span><span class=k>into</span><span class=w> </span><span class=k>table</span><span class=w> </span><span class=k>values</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=s1>&#39;Tom&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>select</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=k>table</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>#</span><span class=w> </span><span class=err>显示表结构</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>describe</span><span class=w> </span><span class=k>table</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>desc</span><span class=w> </span><span class=k>table</span><span class=p>;</span></span></span></code></pre></div></div></div></div><div id=outline-container-headline-18 class=outline-2><h2 id=headline-18>select</h2><div id=outline-text-headline-18 class=outline-text-2><div class="src src-sql"><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>select</span><span class=w> </span><span class=mi>5</span><span class=o>+</span><span class=mi>4</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>select</span><span class=w> </span><span class=mi>5</span><span class=o>+</span><span class=mi>4</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>dual</span><span class=p>;</span></span></span></code></pre></div></div><ul><li><p>select 字断名 from 表名;</p><div class="src src-sql"><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=n>use</span><span class=w> </span><span class=n>mysql</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>select</span><span class=w> </span><span class=n>cost_name</span><span class=p>,</span><span class=n>last_update</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>engine_cost</span><span class=p>;</span></span></span></code></pre></div></div></li><li><p>列的别名</p><div class="src src-sql"><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=n>use</span><span class=w> </span><span class=n>mysql</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>select</span><span class=w> </span><span class=n>cost_name</span><span class=w> </span><span class=n>cname</span><span class=p>,</span><span class=n>last_update</span><span class=w> </span><span class=n>lupdate</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>engine_cost</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>select</span><span class=w> </span><span class=n>cost_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>cname</span><span class=p>,</span><span class=n>last_update</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>lupdate</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>engine_cost</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>select</span><span class=w> </span><span class=n>cost_name</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=s2>&#34;cost名&#34;</span><span class=p>,</span><span class=n>last_update</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=s2>&#34;日期&#34;</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>engine_cost</span><span class=p>;</span></span></span></code></pre></div></div><p><strong>别名用双引</strong></p></li><li><p>空值参于运算</p><div class="src src-sql"><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>create</span><span class=w> </span><span class=k>table</span><span class=w> </span><span class=n>NULLoperation</span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=nb>int</span><span class=p>,</span><span class=n>times</span><span class=w> </span><span class=nb>int</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>show</span><span class=w> </span><span class=k>create</span><span class=w> </span><span class=k>table</span><span class=w> </span><span class=n>NULLoperation</span><span class=err>\</span><span class=k>G</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>select</span><span class=w> </span><span class=n>value</span><span class=p>,</span><span class=n>times</span><span class=p>,</span><span class=n>value</span><span class=o>*</span><span class=n>times</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>NULLoperation</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>insert</span><span class=w> </span><span class=k>into</span><span class=w> </span><span class=n>NULLoperation</span><span class=w> </span><span class=k>values</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span><span class=k>null</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>select</span><span class=w> </span><span class=n>value</span><span class=p>,</span><span class=n>times</span><span class=p>,</span><span class=n>value</span><span class=o>*</span><span class=n>times</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>NULLoperation</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>select</span><span class=w> </span><span class=n>value</span><span class=p>,</span><span class=n>times</span><span class=p>,</span><span class=n>value</span><span class=o>*</span><span class=n>ifnull</span><span class=p>(</span><span class=n>times</span><span class=p>,</span><span class=mi>0</span><span class=p>)</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>NULLoperation</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 空植用零替换: ifnull(times,0)</span></span></span></code></pre></div></div><p><strong>空值参于运算的结呆一定为空</strong>
<strong>空值不等于零</strong></p></li><li><p>过滤条件</p><div class="src src-sql"><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>select</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=n>value</span><span class=p>,</span><span class=n>times</span><span class=p>,</span><span class=n>value</span><span class=o>*</span><span class=n>ifnull</span><span class=p>(</span><span class=n>times</span><span class=p>,</span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>NULLoperation</span><span class=w> </span><span class=k>where</span><span class=w> </span><span class=n>times</span><span class=o>=</span><span class=mi>10</span><span class=p>;</span></span></span></code></pre></div></div><p><strong>where放在from的后面</strong></p></li></ul></div></div><div id=outline-container-headline-19 class=outline-2><h2 id=headline-19>比较</h2><div id=outline-text-headline-19 class=outline-text-2><ul><li>不等于:&lt;>,同!=</li><li>安全等于:*&lt;=>*
可以对NULL进行判断,而不返回NULL,等号有NULL参于就返回NULL</li><li>is null, is not null, isnull()</li><li>least(), greatest()</li><li>beteen and 包含边界</li><li>in (), not in ()</li><li>not/!, and/&&, or/||, xor(逻辑异或)
*not用在where后面</li><li><p>like:模糊查询</p><ul><li><strong>like放在where后面过滤输出结果,多个条件用or,and</strong>
select 1,value,times,value*ifnull(times,1) from NULLoperation where times like '1%';</li><li>select from where like '%a%'
<strong>%号同linux的星</strong></li><li>select from where like '_a%' (查询第二个字符是a的结果)
<strong>_同正则表达式的点</strong></li></ul></li><li><p>regexp/rlike:正则表达式</p><ul><li><strong>regexp/rlike放在where后面过滤输出结果,多个条件用or,and</strong>
select 1,value,times,value*ifnull(times,1) from NULLoperation where times regexp '1.';</li></ul></li></ul></div></div><div id=outline-container-headline-20 class=outline-2><h2 id=headline-20>排序</h2><div id=outline-text-headline-20 class=outline-text-2><ul><li>order by 字段 [asc] (ascend)</li><li>order by 字段 desc (descend)</li><li>列的别名只能在order by中使用,不能在where中使用</li><li><p>二级排序
<strong>在一级排序的结果相同时,再进行排序</strong></p><ul><li>order by 字段 desc 字段 [asc]
*升序可省略asc</li></ul></li></ul></div></div><div id=outline-container-headline-21 class=outline-2><h2 id=headline-21>分页</h2><div id=outline-text-headline-21 class=outline-text-2><ul><li><p>limit 偏移量,条数</p><ul><li>eg limit [0],20 (每页显示20条数据,此时显示第1页)
<strong>偏移量为零可省略</strong></li><li>eg limit 20,20 (每页显示20条数据,此时显示第2页)</li><li>eg limit 40,20 (每页显示20条数据,此时显示第3页)
公式: limit (pageNo-1)*pageSize,pageSize;</li></ul></li><li>mysql8.0新特性: limit 条数 offset 偏移量</li></ul></div></div><div id=outline-container-headline-22 class=outline-2><h2 id=headline-22>约束</h2><div id=outline-text-headline-22 class=outline-text-2><ul><li><p>主键约束</p><div class="src src-sql"><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>create</span><span class=w> </span><span class=k>table</span><span class=w> </span><span class=k>user</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>           </span><span class=n>id</span><span class=w> </span><span class=nb>int</span><span class=w> </span><span class=k>primary</span><span class=w> </span><span class=k>key</span><span class=w> </span><span class=n>auto_increment</span><span class=w> </span><span class=k>comment</span><span class=w> </span><span class=s1>&#39;主键&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>           </span><span class=n>name</span><span class=w> </span><span class=nb>varchar</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span><span class=w> </span><span class=k>not</span><span class=w> </span><span class=k>null</span><span class=w> </span><span class=k>unique</span><span class=w> </span><span class=k>comment</span><span class=w> </span><span class=s1>&#39;姓名&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>           </span><span class=n>age</span><span class=w> </span><span class=nb>int</span><span class=w> </span><span class=k>check</span><span class=w> </span><span class=p>(</span><span class=w> </span><span class=n>age</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>age</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=mi>120</span><span class=w> </span><span class=p>)</span><span class=w> </span><span class=k>comment</span><span class=w> </span><span class=s1>&#39;年龄&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>           </span><span class=n>status</span><span class=w> </span><span class=nb>char</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=s1>&#39;1&#39;</span><span class=w> </span><span class=k>comment</span><span class=w> </span><span class=s1>&#39;状态&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>           </span><span class=n>gender</span><span class=w> </span><span class=nb>char</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>comment</span><span class=w> </span><span class=s1>&#39;性别&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w> </span><span class=k>comment</span><span class=w> </span><span class=s1>&#39;用户表&#39;</span><span class=p>;</span></span></span></code></pre></div></div></li><li><p>外键约束</p><div class="src src-sql"><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>alter</span><span class=w> </span><span class=k>table</span><span class=w> </span><span class=n>emp</span><span class=w> </span><span class=k>add</span><span class=w> </span><span class=k>constraint</span><span class=w> </span><span class=n>fk_emp_dept_id</span><span class=w> </span><span class=k>foreign</span><span class=w> </span><span class=k>key</span><span class=w> </span><span class=p>(</span><span class=n>dept_id</span><span class=p>)</span><span class=w> </span><span class=k>references</span><span class=w> </span><span class=n>dept</span><span class=p>(</span><span class=n>id</span><span class=p>);</span></span></span></code></pre></div></div><ul><li>emp表的dept_id信赖dept表的id</li><li><p>删除</p><div class="src src-sql"><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>alter</span><span class=w> </span><span class=k>table</span><span class=w> </span><span class=n>emp</span><span class=w> </span><span class=k>drop</span><span class=w> </span><span class=k>foreign</span><span class=w> </span><span class=k>key</span><span class=w> </span><span class=n>fk_emp_dept_id</span></span></span></code></pre></div></div></li></ul></li></ul></div></div><div id=outline-container-headline-23 class=outline-2><h2 id=headline-23>事务</h2><div id=outline-text-headline-23 class=outline-text-2><ul><li><p>查询</p><div class="src src-sql"><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=p>(</span><span class=n>root</span><span class=o>@</span><span class=n>localhost</span><span class=p>)</span><span class=w> </span><span class=p>[</span><span class=n>test</span><span class=p>]</span><span class=o>&gt;</span><span class=w> </span><span class=k>select</span><span class=w> </span><span class=o>@@</span><span class=n>autocommit</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+</span><span class=c1>--------------+
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>|</span><span class=w> </span><span class=o>@@</span><span class=n>autocommit</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+</span><span class=c1>--------------+
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>|</span><span class=w>            </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+</span><span class=c1>--------------+
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=mi>1</span><span class=w> </span><span class=k>row</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=k>set</span><span class=w> </span><span class=p>(</span><span class=mi>0</span><span class=p>.</span><span class=mi>00</span><span class=w> </span><span class=n>sec</span><span class=p>)</span></span></span></code></pre></div></div></li><li><p>set @@autocommit = 0;
手动提交</p><div class="src src-sql"><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>set</span><span class=w> </span><span class=o>@@</span><span class=n>autocommit</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>commit</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 回滚事务
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>rollback</span><span class=p>;</span></span></span></code></pre></div></div></li><li>start transaction;</li><li><p>事务隔离级别</p><ul><li><p>查询</p><div class="src src-sql"><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=p>(</span><span class=n>root</span><span class=o>@</span><span class=n>localhost</span><span class=p>)</span><span class=w> </span><span class=p>[</span><span class=n>test</span><span class=p>]</span><span class=o>&gt;</span><span class=w>  </span><span class=k>select</span><span class=w> </span><span class=o>@@</span><span class=n>transaction_isolation</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+</span><span class=c1>-------------------------+
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>|</span><span class=w> </span><span class=o>@@</span><span class=n>transaction_isolation</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+</span><span class=c1>-------------------------+
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>|</span><span class=w> </span><span class=k>REPEATABLE</span><span class=o>-</span><span class=k>READ</span><span class=w>         </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+</span><span class=c1>-------------------------+
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=mi>1</span><span class=w> </span><span class=k>row</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=k>set</span><span class=w> </span><span class=p>(</span><span class=mi>0</span><span class=p>.</span><span class=mi>00</span><span class=w> </span><span class=n>sec</span><span class=p>)</span></span></span></code></pre></div></div></li><li>set session transaction isolation level read_uncommitted;</li></ul></li></ul></div></div><div id=outline-container-headline-24 class=outline-2><h2 id=headline-24>日志</h2><div id=outline-text-headline-24 class=outline-text-2><ul><li><p>二进制日志
<strong>对库的修改</strong></p><div class="src src-sql"><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=p>(</span><span class=n>root</span><span class=o>@</span><span class=n>localhost</span><span class=p>)</span><span class=w> </span><span class=p>[(</span><span class=k>none</span><span class=p>)]</span><span class=o>&gt;</span><span class=w> </span><span class=k>show</span><span class=w> </span><span class=n>variables</span><span class=w> </span><span class=k>like</span><span class=w> </span><span class=s1>&#39;%log_bin%&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+</span><span class=c1>---------------------------------+---------------------------------+
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>|</span><span class=w> </span><span class=n>Variable_name</span><span class=w>                   </span><span class=o>|</span><span class=w> </span><span class=n>Value</span><span class=w>                           </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+</span><span class=c1>---------------------------------+---------------------------------+
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>|</span><span class=w> </span><span class=n>log_bin</span><span class=w>                         </span><span class=o>|</span><span class=w> </span><span class=k>ON</span><span class=w>                              </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>log_bin_basename</span><span class=w>                </span><span class=o>|</span><span class=w> </span><span class=o>/</span><span class=n>var</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>mysql</span><span class=o>/</span><span class=n>gentoo</span><span class=o>-</span><span class=n>bin</span><span class=w>       </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>log_bin_index</span><span class=w>                   </span><span class=o>|</span><span class=w> </span><span class=o>/</span><span class=n>var</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>mysql</span><span class=o>/</span><span class=n>gentoo</span><span class=o>-</span><span class=n>bin</span><span class=p>.</span><span class=k>index</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>log_bin_trust_function_creators</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>OFF</span><span class=w>                             </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>log_bin_use_v1_row_events</span><span class=w>       </span><span class=o>|</span><span class=w> </span><span class=k>OFF</span><span class=w>                             </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>sql_log_bin</span><span class=w>                     </span><span class=o>|</span><span class=w> </span><span class=k>ON</span><span class=w>                              </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+</span><span class=c1>---------------------------------+---------------------------------+
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=mi>6</span><span class=w> </span><span class=k>rows</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=k>set</span><span class=w> </span><span class=p>(</span><span class=mi>0</span><span class=p>.</span><span class=mi>00</span><span class=w> </span><span class=n>sec</span><span class=p>)</span></span></span></code></pre></div></div><ul><li><p>查看日志格式</p><div class="src src-sql"><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=p>(</span><span class=n>root</span><span class=o>@</span><span class=n>localhost</span><span class=p>)</span><span class=w> </span><span class=p>[(</span><span class=k>none</span><span class=p>)]</span><span class=o>&gt;</span><span class=w> </span><span class=k>show</span><span class=w> </span><span class=n>variables</span><span class=w> </span><span class=k>like</span><span class=w> </span><span class=s1>&#39;%binlog_format&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+</span><span class=c1>---------------+-------+
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>|</span><span class=w> </span><span class=n>Variable_name</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>Value</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+</span><span class=c1>---------------+-------+
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>|</span><span class=w> </span><span class=n>binlog_format</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>ROW</span><span class=w>   </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+</span><span class=c1>---------------+-------+
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=mi>1</span><span class=w> </span><span class=k>row</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=k>set</span><span class=w> </span><span class=p>(</span><span class=mi>0</span><span class=p>.</span><span class=mi>01</span><span class=w> </span><span class=n>sec</span><span class=p>)</span></span></span></code></pre></div></div></li><li>mysqlbinlog gentoo-bin.000003 -v
格式为ROW要加-v</li><li><p>删除日志</p><ul><li>reset master
删除全部</li><li>purge master logs to 'binlog.***'
删除***之前的所有日志</li><li>purge master logs before 'yyyy-mm-dd hh:mm:ss'</li></ul></li><li><p>过期时间</p><div class="src src-sql"><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=p>(</span><span class=n>root</span><span class=o>@</span><span class=n>localhost</span><span class=p>)</span><span class=w> </span><span class=p>[(</span><span class=k>none</span><span class=p>)]</span><span class=o>&gt;</span><span class=w> </span><span class=k>show</span><span class=w> </span><span class=n>variables</span><span class=w> </span><span class=k>like</span><span class=w> </span><span class=s1>&#39;%binlog_expire%&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+</span><span class=c1>-------------------------------+---------+
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>|</span><span class=w> </span><span class=n>Variable_name</span><span class=w>                 </span><span class=o>|</span><span class=w> </span><span class=n>Value</span><span class=w>   </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+</span><span class=c1>-------------------------------+---------+
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>|</span><span class=w> </span><span class=n>binlog_expire_logs_auto_purge</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>ON</span><span class=w>      </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>binlog_expire_logs_seconds</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=mi>2592000</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+</span><span class=c1>-------------------------------+---------+
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=mi>2</span><span class=w> </span><span class=k>rows</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=k>set</span><span class=w> </span><span class=p>(</span><span class=mi>0</span><span class=p>.</span><span class=mi>00</span><span class=w> </span><span class=n>sec</span><span class=p>)</span></span></span></code></pre></div></div><p>30天后会自动删除</p></li></ul></li><li><p>查询日志
<strong>对库的查询</strong></p><div class="src src-sql"><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=p>(</span><span class=n>root</span><span class=o>@</span><span class=n>localhost</span><span class=p>)</span><span class=w> </span><span class=p>[(</span><span class=k>none</span><span class=p>)]</span><span class=o>&gt;</span><span class=w> </span><span class=k>show</span><span class=w> </span><span class=n>variables</span><span class=w> </span><span class=k>like</span><span class=w> </span><span class=s1>&#39;%general%&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+</span><span class=c1>------------------+---------------------------+
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>|</span><span class=w> </span><span class=n>Variable_name</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>Value</span><span class=w>                     </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+</span><span class=c1>------------------+---------------------------+
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>|</span><span class=w> </span><span class=n>general_log</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=k>OFF</span><span class=w>                       </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>general_log_file</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=o>/</span><span class=n>var</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>mysql</span><span class=o>/</span><span class=n>gentoo</span><span class=p>.</span><span class=n>log</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>+</span><span class=c1>------------------+---------------------------+
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=mi>2</span><span class=w> </span><span class=k>rows</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=k>set</span><span class=w> </span><span class=p>(</span><span class=mi>0</span><span class=p>.</span><span class=mi>00</span><span class=w> </span><span class=n>sec</span><span class=p>)</span></span></span></code></pre></div></div><p><strong>查询日志默认关闭</strong></p></li><li><p>慢查询日志</p><ul><li><p>开启慢查询</p><div class="src src-cnf"><pre tabindex=0><code class=language-cnf data-lang=cnf>#开启慢查询
slow_query_log=1
#慢查询时间参数
long_query_time=2</code></pre></div></li></ul></li></ul></div></div><div id=outline-container-headline-25 class=outline-2><h2 id=headline-25>主从复制</h2><div id=outline-text-headline-25 class=outline-text-2><ul><li><p>主库配置</p><ol><li><p>/etc/my.cnf</p><div class="src src-cnf"><pre tabindex=0><code class=language-cnf data-lang=cnf>server-id=1
read-only=0</code></pre></div></li><li><p>创建用户</p><div class="src src-sql"><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>create</span><span class=w> </span><span class=k>user</span><span class=w> </span><span class=s1>&#39;f&#39;</span><span class=o>@</span><span class=s1>&#39;%&#39;</span><span class=w> </span><span class=n>identified</span><span class=w> </span><span class=k>with</span><span class=w> </span><span class=n>mysql_native_password</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=s1>&#39;f&#39;</span><span class=p>;</span></span></span></code></pre></div></div></li><li><p>授于权限</p><div class="src src-sql"><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>grant</span><span class=w> </span><span class=n>replication</span><span class=w> </span><span class=n>slave</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=o>*</span><span class=p>.</span><span class=o>*</span><span class=w> </span><span class=k>to</span><span class=w> </span><span class=s1>&#39;f&#39;</span><span class=o>@</span><span class=s1>&#39;%&#39;</span><span class=p>;</span></span></span></code></pre></div></div></li><li><p>查看二进制日志坐标</p><div class="src src-sql"><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>show</span><span class=w> </span><span class=n>master</span><span class=w> </span><span class=n>status</span><span class=p>;</span></span></span></code></pre></div></div></li></ol></li><li><p>从库配置</p><ol><li><p>/etc/my.cnf</p><div class="src src-cnf"><pre tabindex=0><code class=language-cnf data-lang=cnf>server-id=2
read-only=1</code></pre></div></li><li><p>8.0.23之前</p><div class="src src-sql"><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=n>change</span><span class=w> </span><span class=n>replication</span><span class=w> </span><span class=k>source</span><span class=w> </span><span class=k>to</span><span class=w> </span><span class=n>source_host</span><span class=o>=</span><span class=s1>&#39;xxx.xxx&#39;</span><span class=p>,</span><span class=n>source_user</span><span class=o>=</span><span class=s1>&#39;xxx&#39;</span><span class=p>,</span><span class=n>source_log_file</span><span class=o>=</span><span class=s1>&#39;xxx&#39;</span><span class=p>,</span><span class=n>source_log_pos</span><span class=o>=</span><span class=n>xxx</span><span class=p>;</span></span></span></code></pre></div></div><p>如果是8.0.23之前的版本,执行如下sql:</p><div class="src src-sql"><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=n>change</span><span class=w> </span><span class=n>replication</span><span class=w> </span><span class=n>master</span><span class=w> </span><span class=k>to</span><span class=w> </span><span class=n>master_host</span><span class=o>=</span><span class=s1>&#39;xxx.xxx&#39;</span><span class=p>,</span><span class=n>master_user</span><span class=o>=</span><span class=s1>&#39;xxx&#39;</span><span class=p>,</span><span class=n>master_log_file</span><span class=o>=</span><span class=s1>&#39;xxx&#39;</span><span class=p>,</span><span class=n>master_log_pos</span><span class=o>=</span><span class=n>xxx</span><span class=p>;</span></span></span></code></pre></div></div></li><li><p>开启同步操作</p><div class="src src-sql"><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>start</span><span class=w> </span><span class=n>replica</span><span class=p>;</span><span class=w> </span><span class=o>#</span><span class=mi>8</span><span class=p>.</span><span class=mi>0</span><span class=p>.</span><span class=mi>22</span><span class=err>之后</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>start</span><span class=w> </span><span class=n>slave</span><span class=p>;</span><span class=w> </span><span class=o>#</span><span class=mi>8</span><span class=p>.</span><span class=mi>0</span><span class=p>.</span><span class=mi>22</span><span class=err>之前</span></span></span></code></pre></div></div></li><li><p>查看主从同步状态</p><div class="src src-sql"><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>start</span><span class=w> </span><span class=n>replica</span><span class=w> </span><span class=n>status</span><span class=err>\</span><span class=k>G</span><span class=p>;</span><span class=w> </span><span class=o>#</span><span class=mi>8</span><span class=p>.</span><span class=mi>0</span><span class=p>.</span><span class=mi>22</span><span class=err>之后</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>start</span><span class=w> </span><span class=n>slave</span><span class=w> </span><span class=n>status</span><span class=err>\</span><span class=k>G</span><span class=p>;</span><span class=w> </span><span class=o>#</span><span class=mi>8</span><span class=p>.</span><span class=mi>0</span><span class=p>.</span><span class=mi>22</span><span class=err>之前</span></span></span></code></pre></div></div><ul><li>查看replica_io_running和replica_sql_running是否为yes</li></ul></li></ol></li></ul></div></div></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://tazegi.github.io/post/%E8%BF%90%E7%BB%B4/apache2/><span class=title>« Prev</span><br><span>Apache2</span></a>
<a class=next href=https://tazegi.github.io/post/%E8%BF%90%E7%BB%B4/ansible/><span class=title>Next »</span><br><span>Ansible</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Mysql on twitter" href="https://twitter.com/intent/tweet/?text=Mysql&url=https%3a%2f%2ftazegi.github.io%2fpost%2f%25E8%25BF%2590%25E7%25BB%25B4%2fmysql%2f&hashtags="><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Mysql on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2ftazegi.github.io%2fpost%2f%25E8%25BF%2590%25E7%25BB%25B4%2fmysql%2f&title=Mysql&summary=Mysql&source=https%3a%2f%2ftazegi.github.io%2fpost%2f%25E8%25BF%2590%25E7%25BB%25B4%2fmysql%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Mysql on reddit" href="https://reddit.com/submit?url=https%3a%2f%2ftazegi.github.io%2fpost%2f%25E8%25BF%2590%25E7%25BB%25B4%2fmysql%2f&title=Mysql"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Mysql on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2ftazegi.github.io%2fpost%2f%25E8%25BF%2590%25E7%25BB%25B4%2fmysql%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Mysql on whatsapp" href="https://api.whatsapp.com/send?text=Mysql%20-%20https%3a%2f%2ftazegi.github.io%2fpost%2f%25E8%25BF%2590%25E7%25BB%25B4%2fmysql%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Mysql on telegram" href="https://telegram.me/share/url?text=Mysql&url=https%3a%2f%2ftazegi.github.io%2fpost%2f%25E8%25BF%2590%25E7%25BB%25B4%2fmysql%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://tazegi.github.io>tazigi's blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>